generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Users {
  id               String           @id @default(uuid())
  name             String
  email            String           @unique
  createdAt        DateTime         @default(now())
  role             Role             @default(candidate)
  password         String?
  Job              Job[]            @relation("UserPostedJobs")
  JobApplications  JobApplication[]
  SavedJobs        SavedJob[]
  CandidateProfile UserProfile?     @relation("CandidateUserProfile")
  VendorProfiles   UserProfile[]    @relation("VendorUserProfiles")
}

model UserProfile {
  id                           String    @id @default(uuid())
  userId                       String?   @unique
  profilePicture               String?
  preferredLocation            String[]
  preferredJobType             JobType[]
  currentCTC                   String?
  expectedCTC                  String?
  joiningPeriod                String?
  totalExperience              String?
  relevantSalesforceExperience String?
  certifications               String[]
  createdAt                    DateTime  @default(now())
  updatedAt                    DateTime  @updatedAt
  linkedInUrl                  String?
  skillsJson                   Json?
  title                        String?
  trailheadUrl                 String?
  currentLocation              String?
  education                    Json?
  workExperience               Json?
  primaryClouds                Json?
  secondaryClouds              Json?
  venderId                     String?
  vendorId                     String?
  email                        String?
  name                         String?
  phoneNumber                  String?
  portfolioLink                String?
  rateCardPerHour              Json?
  isVerified                   Boolean   @default(false)
  otpExpiry                    DateTime?
  verificationOtp              String?
  companyName                  String?
  firstName                    String?
  lastName                     String?
  address                      Address?
  user                         Users?    @relation("CandidateUserProfile", fields: [userId], references: [id], onDelete: Cascade)
  vendor                       Users?    @relation("VendorUserProfiles", fields: [vendorId], references: [id], onDelete: Cascade)
}

model Skills {
  id         String  @id @default(uuid())
  name       String  @unique
  isVerified Boolean @default(false)
}

model Certification {
  id         String  @id @default(uuid())
  name       String  @unique
  isVerified Boolean @default(false)
}

model Location {
  id         String  @id @default(uuid())
  name       String  @unique
  isVerified Boolean @default(false)
}

model Cloud {
  id         String  @id @default(uuid())
  name       String  @unique
  isVerified Boolean @default(false)
}

model Job {
  id                  String           @id @default(uuid())
  experience          String?
  location            String?
  description         String?
  skills              String[]
  updatedAt           DateTime         @updatedAt
  applicationDeadline String
  companyName         String
  createdAt           DateTime         @default(now())
  employmentType      EmploymentType
  experienceLevel     ExperienceLevel?
  jobType             String
  postedById          String?
  qualifications      String[]
  responsibilities    String[]
  role                String
  salary              Int
  status              JobStatus        @default(Open)
  deletedAt           DateTime?
  deletedReason       String?
  isDeleted           Boolean          @default(false)
  clouds              String[]
  postedBy            Users?           @relation("UserPostedJobs", fields: [postedById], references: [id])
  applications        JobApplication[]
  savedBy             SavedJob[]
}

model JobApplication {
  id        String            @id @default(uuid())
  jobId     String
  userId    String
  status    ApplicationStatus @default(Pending)
  appliedAt DateTime          @default(now())
  updatedAt DateTime          @updatedAt
  job       Job               @relation(fields: [jobId], references: [id], onDelete: Cascade)
  user      Users             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([jobId, userId])
  @@index([userId])
  @@index([jobId])
}

model SavedJob {
  id      String   @id @default(uuid())
  jobId   String
  userId  String
  savedAt DateTime @default(now())
  job     Job      @relation(fields: [jobId], references: [id], onDelete: Cascade)
  user    Users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([jobId, userId])
  @@index([userId])
  @@index([jobId])
}

model Address {
  id         String      @id @default(uuid())
  doorNumber String?
  street     String?
  city       String?
  state      String?
  country    String?
  pinCode    String?
  profileId  String      @unique
  profile    UserProfile @relation(fields: [profileId], references: [id])
}

model Country {
  id     String  @id @default(uuid())
  name   String  @unique
  code   String?
  states State[]
}

model State {
  id        String  @id @default(uuid())
  name      String
  code      String?
  countryId String
  country   Country @relation(fields: [countryId], references: [id])
}

enum Role {
  candidate
  company
  admin
}

enum JobType {
  FullTime
  Contract
  Freelance
}

enum EmploymentType {
  FullTime
  PartTime
  Internship
  Contract
  Freelance
}

enum ExperienceLevel {
  Internship
  EntryLevel
  Mid
  Senior
  Lead
}

enum JobStatus {
  Open
  Closed
  Draft
}

enum ApplicationStatus {
  Pending
  Reviewed
  Shortlisted
  Rejected
  Hired
}
